@import url('https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,200..900&family=IBM+Plex+Mono:wght@300;400;600&display=swap');
@import 'tailwindcss';

/* Tailwind v4 CSS-first design system.
   Keep tokens aligned to the pre-refactor baseline visuals. */
@theme {
  --color-background: #07090d;
  --color-surface: rgba(255, 255, 255, 0.06);
  --color-surface-2: rgba(255, 255, 255, 0.04);

  --color-foreground: rgba(242, 246, 255, 0.92);
  --color-muted: rgba(242, 246, 255, 0.62);
  --color-faint: rgba(242, 246, 255, 0.18);

  --color-border: rgba(255, 255, 255, 0.12);
  --color-border-2: rgba(255, 255, 255, 0.18);

  --color-accent: #ff6a00;
  --color-accent-2: #2dd4bf;
  --color-danger: #ff3b3b;

  --shadow-color: rgba(0, 0, 0, 0.5);

  --radius-xl: 22px;
  --radius-lg: 16px;
  --radius-md: 12px;

  --font-display: 'Fraunces', ui-serif, Georgia, serif;
  --font-mono: 'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, monospace;

  --animate-overlay-in: overlay-in 160ms ease-out;
  --animate-overlay-out: overlay-out 140ms ease-in;
  --animate-modal-in: modal-in 200ms ease-out;
  --animate-modal-out: modal-out 160ms ease-in;

  @keyframes overlay-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes overlay-out {
    from {
      opacity: 1;
    }
    to {
      opacity: 0;
    }
  }

  @keyframes modal-in {
    from {
      opacity: 0;
      transform: translateY(-8px) scale(0.98);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  @keyframes modal-out {
    from {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
    to {
      opacity: 0;
      transform: translateY(-8px) scale(0.98);
    }
  }

  @keyframes merossity-reloadGlowSpin {
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes merossity-iconSpin {
    to {
      transform: rotate(360deg);
    }
  }
}

@layer base {
  :root {
    color-scheme: dark;
  }

  body {
    font-family: var(--font-mono);
    @apply bg-background text-foreground m-0 min-h-screen min-w-[320px] antialiased;
  }

  ::selection {
    background: rgba(255, 106, 0, 0.35);
  }
}

@layer utilities {
  /* Atmosphere */
  .lab-bg {
    background:
      radial-gradient(1200px 700px at 12% 6%, rgba(255, 106, 0, 0.2), transparent 58%),
      radial-gradient(900px 650px at 92% 18%, rgba(45, 212, 191, 0.18), transparent 62%),
      radial-gradient(900px 500px at 50% 110%, rgba(255, 255, 255, 0.06), transparent 72%),
      linear-gradient(180deg, #07090d, #0e1626);
    position: relative;
    overflow-x: clip;
  }

  .lab-bg::before {
    content: '';
    position: fixed;
    inset: 0;
    pointer-events: none;
    background: repeating-linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.025) 0px,
      rgba(255, 255, 255, 0.025) 1px,
      transparent 1px,
      transparent 4px
    );
    opacity: 0.55;
    mix-blend-mode: overlay;
  }

  /* Panels */
  .glass-panel {
    border: 1px solid var(--color-border);
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.07), rgba(255, 255, 255, 0.04));
    box-shadow: 0 34px 80px var(--shadow-color);
    backdrop-filter: blur(10px);
  }

  .shadow-panel {
    box-shadow: 0 34px 80px var(--shadow-color);
  }

  /* Buttons (helpers) */
  .btn-iconOnly {
    width: 44px;
    padding-left: 0;
    padding-right: 0;
  }

  /* Device cards */
  .device-card {
    position: relative;
    border: 1px solid rgba(255, 255, 255, 0.12);
    background: rgba(255, 255, 255, 0.05);
    border-radius: var(--radius-lg);
    overflow: hidden;
  }

  .device-card > * {
    position: relative;
    z-index: 1;
  }

  .device-card--on {
    border-color: rgba(255, 176, 72, 0.34);
    background:
      radial-gradient(620px 260px at 22% -10%, rgba(255, 176, 72, 0.22), transparent 62%),
      radial-gradient(560px 300px at 70% 110%, rgba(255, 255, 255, 0.1), transparent 58%), rgba(255, 255, 255, 0.05);
    box-shadow:
      0 22px 54px rgba(0, 0, 0, 0.42),
      0 12px 42px rgba(255, 176, 72, 0.18),
      0 0 76px rgba(255, 255, 255, 0.1),
      0 0 0 1px rgba(255, 176, 72, 0.28) inset;
  }

  .device-card--on::before {
    content: '';
    position: absolute;
    inset: -24px;
    border-radius: calc(var(--radius-lg) + 24px);
    background:
      radial-gradient(closest-side, rgba(255, 176, 72, 0.22), transparent 64%),
      radial-gradient(closest-side, rgba(255, 255, 255, 0.18), transparent 72%);
    filter: blur(20px) saturate(125%);
    opacity: 1;
    pointer-events: none;
    z-index: 0;
  }

  .device-card--off {
    border-color: rgba(255, 255, 255, 0.12);
    background:
      radial-gradient(540px 200px at 10% 0%, rgba(255, 255, 255, 0.07), transparent 66%), rgba(255, 255, 255, 0.04);
  }

  .device-card--inaccessible .text-foreground {
    color: rgba(242, 246, 255, 0.68);
  }

  /* Reload glow (busy only) */
  .reload-glow {
    position: relative;
    overflow: visible;
    z-index: 0;
  }

  .reload-glow::before {
    content: '';
    position: absolute;
    inset: -6px;
    border-radius: 999px;
    background:
      radial-gradient(closest-side, rgba(242, 246, 255, 0.22), transparent 60%),
      repeating-conic-gradient(
        from 0deg,
        rgba(45, 212, 191, 0.7) 0 14deg,
        rgba(255, 106, 0, 0.7) 14deg 28deg,
        rgba(255, 59, 59, 0.65) 28deg 42deg,
        rgba(180, 107, 255, 0.55) 42deg 56deg
      );
    filter: blur(10px) saturate(140%);
    opacity: 0;
    transform: rotate(0deg);
    transition: opacity 180ms ease;
    pointer-events: none;
  }

  .reload-glow.is-busy::before {
    opacity: 0.9;
    animation: merossity-reloadGlowSpin 1.15s linear infinite;
  }

  .icon-spin {
    animation: merossity-iconSpin 0.95s linear infinite;
    transform-origin: 50% 50%;
  }
}
